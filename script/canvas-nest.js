!function(){console.log("加载 canvas-nest.js");var t,i,o,n,e,s=window.requestAnimationFrame||function(t){window.setTimeout(t,1e3/60)},h=document.getElementById("db_bg_canvas_nest"),r=h.getContext("2d"),a=[],c=function(){h.width=window.innerWidth,h.height=window.innerHeight,t=Math.round(Math.sqrt(h.width*h.width+h.height*h.height)),Math.floor(h.width/2),Math.floor(h.height/2),a.length=0,v(),f()};window.addEventListener("resize",(function(){c()}),!1);var p=function(t,i){return Math.floor(Math.random()*i)+t},u=function(t,i){var o=Math.round(Math.abs(t.positionX-i.positionX)),n=Math.round(Math.abs(t.positionY-i.positionY));return Math.round(Math.sqrt(o*o+n*n))};function d(t,i,o,n,e,s,h){this.positionX=t,this.positionY=i,this.size=o,this.duration=p(50,300),this.limit=50,this.timer=0,this.red=n,this.green=e,this.blue=s,this.opacity=h,this.color="rgba("+this.red+","+this.green+","+this.blue+",+"+this.opacity+")"}function l(t,n,e,s,h,r,a){this.positionX=i,this.positionY=o,this.size=e,this.red=s,this.green=h,this.blue=r,this.opacity=a,this.color="rgba("+this.red+","+this.green+","+this.blue+",+"+this.opacity+")"}d.prototype.animateTo=function(t,i){var o=this.duration,n=function(t,i){return t=t>i?i+(t-i)/o:i-(i-t)/o};this.positionX=n(t,this.positionX),this.positionY=n(i,this.positionY),this.timer==this.duration?(this.calculateVector(),this.timer=0):this.timer++},d.prototype.updateColor=function(){this.color="rgba("+this.red+","+this.green+","+this.blue+",+"+this.opacity+")"},d.prototype.calculateVector=function(){for(var t,i={};void 0===t||t>this.limit;)i.positionX=p(0,window.innerWidth),i.positionY=p(0,window.innerHeight),t=u(this,i);this.vectorX=i.positionX,this.vectorY=i.positionY},d.prototype.testInteraction=function(){for(var i,o=t,n=0;n<a.length;n++){var e=a[n],s=u(this,e);s<o&&e!==this&&(o=s,i=e)}i&&(r.beginPath(),r.moveTo(this.positionX+this.size/2,this.positionY+this.size/2),r.lineTo(i.positionX+.5*i.size,i.positionY+.5*i.size),r.strokeStyle="rgba(178,182,182,0.4)",r.stroke())},l.prototype.testInteraction=function(){for(var t=[],i=0;i<a.length;i++){var o=a[i];u(this,o)<150&&o!==this&&t.push(a[i])}for(i=0;i<t.length;i++){var n=t[i];r.beginPath(),r.moveTo(this.positionX,this.positionY),r.lineTo(n.positionX+.5*n.size,n.positionY+.5*n.size),r.strokeStyle="rgba(178,182,182,0.4)",r.stroke(),t[i].vectorX=this.positionX,t[i].vectorY=this.positionY}},d.prototype.updateAnimation=function(){this.animateTo(this.vectorX,this.vectorY),this.testInteraction(),r.fillStyle=this.color,r.fillRect(this.positionX,this.positionY,this.size,this.size)},l.prototype.updateAnimation=function(){this.positionX=i,this.positionY=o,this.testInteraction()};var f=function(){n=new l(0,0,3,255,255,255);for(var t=0;t<80;t++){var i=new d(Math.floor(Math.random()*window.innerWidth+1),Math.floor(Math.random()*window.innerHeight+1),3,166,126,183,.6);i.calculateVector(),a.push(i)}};window.onmousemove=function(t){i=t.clientX,o=t.clientY};var w,g,v=function(){r.clearRect(0,0,window.innerWidth,window.innerHeight)},m=0,X=0,Y=function(){v(),function(){for(var t=0;t<a.length;t++)a[t].updateAnimation();n.updateAnimation()}(),s(Y),function(){if(!w)return w=Date.now(),void(g=0);e=((new Date).getTime()-w)/1e3,w=Date.now(),g=Math.floor(1/e),m+=g,5==++X&&(Math.floor(m/5),X=0,m=0)}()};c(),Y()}();